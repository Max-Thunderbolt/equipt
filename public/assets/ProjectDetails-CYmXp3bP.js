import{g as qe,y as Je,r as u,h as ve,d as Me,z as Ie,i as Ve,A as Be,x as Ne,c as t,b as v,t as n,a as e,u as S,F,k as L,l as _e,m as ce,j as x,w as D,v as Z,B as $e,q as ze,s as y,o as a,n as Ge,C as pe}from"./index-BzJ7YkvY.js";import{u as Ke,F as he}from"./FilesGrid-DK2Ef0U4.js";const We={class:"project-details container"},Ye={key:0,class:"loading"},He={key:1,class:"error-message"},Qe={key:2,class:"project-content"},Xe={class:"project-header"},Ze={class:"project-meta"},eo={class:"date"},oo={class:"version"},so={class:"project-body"},to={class:"project-info"},ao={class:"info-card"},lo=e("h3",{"data-icon":"description"},"Description",-1),ro={class:"owner-collab-group"},io={class:"info-card owner-card"},no=e("h3",{"data-icon":"owner"},"Project Owner",-1),co={class:"owner-info"},uo={class:"user-avatar"},vo=["src","alt"],_o={key:1,class:"avatar-placeholder"},po={key:0,class:"info-card collab-card"},ho=e("h3",{"data-icon":"collaborators"},"Collaborators",-1),fo={class:"collaborators-grid"},mo={class:"user-avatar small"},bo=["src","alt"],yo={key:1,class:"avatar-placeholder"},go={class:"user-details"},wo={class:"user-name"},Co=["title"],ko={class:"project-files"},jo={class:"info-card files-card"},Eo=e("h3",{"data-icon":"files"},"Files",-1),Po={key:0,class:"info-card"},Ro=e("h3",{"data-icon":"settings"},"Project Actions",-1),Oo={class:"project-actions"},So=e("span",{class:"icon"},"+",-1),Do={class:"project-updates"},Uo=e("h3",{"data-icon":"updates"},"Project Updates",-1),To={key:0,class:"updates-list"},Ao={class:"update-header"},Fo={class:"user-info"},Lo={class:"user-avatar"},xo=["src","alt"],qo={key:1,class:"avatar-placeholder"},Jo={class:"update-author"},Mo={class:"update-date"},Io={class:"update-content"},Vo={class:"update-text"},Bo={key:0,class:"update-files"},No={key:1,class:"empty-updates empty-state"},$o=e("p",null,'No updates yet. Click "Add Progress / Update Project" to add the first update.',-1),zo=[$o],Go=e("h2",null,"Add Progress / Update Project",-1),Ko={class:"form-group"},Wo=e("label",{for:"update-description"},"What changes have you made?",-1),Yo={class:"form-group"},Ho=e("label",{for:"update-files"},"Upload New Files",-1),Qo={class:"file-upload-container"},Xo=["disabled"],Zo=e("div",{class:"file-upload-box"},[e("span",{class:"upload-icon"},"📎"),e("span",null,"Drop files here or click to upload")],-1),es={key:0,class:"file-list"},os={key:1,class:"upload-progress"},ss={class:"progress-bar"},ts={class:"progress-text"},as={key:0,class:"error-message"},ls={class:"form-actions"},rs=["disabled"],is=e("h2",null,"Edit Project",-1),ns={class:"form-group"},cs=e("label",{for:"edit-name"},"Project Name",-1),ds={class:"form-group"},us=e("label",{for:"edit-description"},"Description",-1),vs={class:"form-group checkbox-group"},_s={class:"checkbox-label"},ps=e("span",null,"Make this project public",-1),hs=e("small",{class:"checkbox-help"},"Public projects are visible to everyone",-1),fs={class:"form-group collaborators-section"},ms=e("h3",null,"Invite Collaborators",-1),bs={key:0,class:"current-collaborators"},ys=e("h4",null,"Current Collaborators",-1),gs={class:"collaborator-list"},ws={class:"collab-user"},Cs={class:"user-avatar small"},ks=["src","alt"],js={key:1,class:"avatar-placeholder"},Es={class:"collab-name"},Ps={class:"collab-actions"},Rs=["onUpdate:modelValue","onChange","disabled"],Os=e("option",{value:"viewer"},"Viewer",-1),Ss=e("option",{value:"editor"},"Editor",-1),Ds=e("option",{value:"admin"},"Admin",-1),Us=[Os,Ss,Ds],Ts={key:1,class:"role-badge owner"},As={key:2,class:"spinner-small role-spinner"},Fs=["onClick"],Ls={class:"search-container"},xs=e("label",{for:"user-search"},"Search users to invite",-1),qs={class:"search-input-wrapper"},Js={key:0,class:"search-loading"},Ms=e("div",{class:"spinner-small"},null,-1),Is=[Ms],Vs={key:0,class:"search-results"},Bs=["onClick"],Ns={class:"user-info"},$s={class:"user-avatar small"},zs=["src","alt"],Gs={key:1,class:"avatar-placeholder"},Ks={class:"user-details"},Ws={class:"user-name"},Ys={class:"user-email"},Hs=e("div",{class:"add-btn"},"+ Add",-1),Qs={key:1,class:"no-results"},Xs={key:1,class:"new-collaborators"},Zs=e("h4",null,"Users to be added",-1),et={class:"collaborator-list"},ot={class:"collab-user"},st={class:"user-avatar small"},tt=["src","alt"],at={key:1,class:"avatar-placeholder"},lt={class:"collab-name"},rt={class:"collab-actions"},it=["onUpdate:modelValue"],nt=e("option",{value:"viewer"},"Viewer",-1),ct=e("option",{value:"editor"},"Editor",-1),dt=e("option",{value:"admin"},"Admin",-1),ut=[nt,ct,dt],vt=["onClick"],_t={key:0,class:"error-message"},pt={class:"form-actions"},ht=["disabled"],ft=e("h2",null,"Delete Project",-1),mt={class:"confirm-content"},bt=e("p",{class:"confirm-message"}," Are you sure you want to delete this project? This action cannot be undone. ",-1),yt=e("p",{class:"confirm-details"}," This will permanently delete all project files, updates, and remove all collaborators. ",-1),gt={key:0,class:"error-message"},wt={class:"form-actions"},Ct=["disabled"],kt=e("h2",null,"Remove Collaborator",-1),jt={class:"confirm-content"},Et={class:"confirm-message"},Pt=e("p",{class:"confirm-details"}," They will lose access to this project and will need to be invited again to regain access. ",-1),Rt={class:"form-actions"},Ot=["disabled"],Tt={__name:"ProjectDetails",setup(St){const b={PROJECTS:"projects",PROFILES:"profiles",PROJECT_COLLABORATORS:"project_collaborators",PROJECT_FILES:"project_files",PROJECT_UPDATES:"project_updates"},fe=Be(),q=Ne(),{user:E}=Me();qe();const{searchResults:ee,loading:me,searchUsers:be}=Je(),{uploadFile:ye,downloadFile:ge,getFileUrl:we,updateMissingFileUrls:Ce,progress:oe,deleteFile:ke}=Ke(),m=u(""),l=u(null),se=u(!0),j=u(null),te=u(!1),w=u({description:"",files:[]}),P=u(!1),J=u(null),ae=u(!1),p=u({name:"",description:"",is_public:!1,newCollaborators:[]}),G=u(!1),C=u(null),M=u(""),U=u(!1),le=u(!1),K=u(!1),I=u(null),re=u(!1),V=u(null),W=u(null),Y=u(!1),je=()=>{w.value={description:"",files:[]},J.value=null,te.value=!0},H=()=>{te.value=!1},Ee=s=>{w.value.files=Array.from(s.target.files)},Pe=async()=>{var s;if(!P.value){P.value=!0,J.value=null;try{if(!w.value.description.trim()){_.value="Please provide a description of your update",P.value=!1;return}const r={project_id:m.value,description:w.value.description,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),user_id:(s=E.value)==null?void 0:s.id};console.log("Submitting update:",r);const{data:d,error:_}=await y.from(b.PROJECT_UPDATES).insert(r).select("*").single();if(_)throw _;if(w.value.files.length>0)for(const g of w.value.files)oe.value=0,await ye(g,m.value,d.id);await B(),H()}catch(r){console.error("Error submitting update:",r),J.value="Failed to submit update. Please try again."}finally{P.value=!1}}},B=async()=>{if(m.value){se.value=!0,j.value=null;try{console.log("Fetching project with ID:",m.value);const{data:s,error:r}=await y.from(b.PROJECTS).select(`
        *,
        ${b.PROJECT_FILES}(*)
      `).eq("id",m.value).single();if(r)throw r;const{data:d,error:_}=await y.from(b.PROFILES).select("*").eq("id",s.owner_id).single();_&&console.error("Error fetching owner:",_);const{data:g,error:$}=await y.from(b.PROJECT_COLLABORATORS).select("role, user_id").eq("project_id",m.value);$&&console.error("Error fetching collaborators:",$);let A=[];if(g&&g.length>0){const c=g.map(f=>f.user_id),{data:i,error:h}=await y.from(b.PROFILES).select("*").in("id",c);h?console.error("Error fetching collaborator profiles:",h):A=i||[]}const{data:R,error:z}=await y.from(b.PROJECT_UPDATES).select("*").eq("project_id",m.value).order("created_at",{ascending:!1});if(z)console.error("Error fetching project updates:",z);else if(R&&R.length>0){const c=[...new Set(R.map(f=>f.user_id))],{data:i,error:h}=await y.from(b.PROFILES).select("id, display_name, avatar_url").in("id",c);h?console.error("Error fetching user profiles:",h):R.forEach(f=>{f.user=i.find(k=>k.id===f.user_id)||null}),s.updates=R}else s.updates=[];if(console.log("Project data:",s),console.log("Owner data:",d),console.log("Collaborators:",g),console.log("User profiles:",A),l.value={...s,owner:d||null,collaborators:(g||[]).map(c=>({...c,user:A.find(i=>i.id===c.user_id)||null})),files:s.project_files||[],updates:s.updates||[]},E.value){if(!(l.value.owner_id===E.value.id||l.value.collaborators.some(i=>i.user_id===E.value.id))&&!l.value.is_public){j.value="You don't have access to this project",q.push("/projects");return}}else if(!l.value.is_public){q.push("/projects");return}await(async()=>{if(!l.value||!l.value.files||l.value.files.length===0)return;console.log("Checking file URLs for",l.value.files.length,"files"),l.value.files=l.value.files.map(i=>(!i.url&&i.file_path&&(i.url=we(i.file_path),console.log(`Generated temporary URL for ${i.name}:`,i.url)),i));const c=l.value.files.filter(i=>!i.url&&i.file_path);c.length>0&&(console.log("Updating URLs for",c.length,"files in the database"),await Ce(c))})(),console.log("Combined project data:",l.value),console.log("Project files:",l.value.files),console.log("Project owner:",l.value.owner),console.log("Project collaborators:",l.value.collaborators)}catch(s){console.error("Error fetching project details:",s),j.value=s.message}finally{se.value=!1}}},de=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),N=ve(()=>E.value&&l.value&&l.value.owner_id===E.value.id),T=ve(()=>{if(!E.value||!l.value||!l.value.collaborators)return null;const s=l.value.collaborators.find(r=>r.user&&r.user.id===E.value.id);return s?s.role:null});Ie(M,async s=>{s.length>=2?(await be(s),U.value=!0):U.value=!1});const Re=s=>{const r=l.value.collaborators.some(_=>_.user&&_.user.id===s.id),d=p.value.newCollaborators.some(_=>_.id===s.id);if(r){C.value=`${s.display_name} is already a collaborator`;return}if(d){C.value=`${s.display_name} has already been added`;return}p.value.newCollaborators.push({id:s.id,display_name:s.display_name,email:s.email,avatar_url:s.avatar_url,role:"viewer"}),M.value="",U.value=!1,C.value=null},Oe=s=>{p.value.newCollaborators.splice(s,1)},Se=()=>{p.value={name:l.value.name||"",description:l.value.description||"",is_public:l.value.is_public||!1,newCollaborators:[]},M.value="",U.value=!1,C.value=null,ae.value=!0},Q=()=>{ae.value=!1},De=async()=>{if(!p.value.name){C.value="Project name is required";return}G.value=!0,C.value=null;try{const{data:s,error:r}=await y.from(b.PROJECTS).update({name:p.value.name,description:p.value.description,is_public:p.value.is_public,updated_at:new Date().toISOString()}).eq("id",m.value).select().single();if(r)throw r;if(p.value.newCollaborators.length>0){const d=p.value.newCollaborators.map(g=>({project_id:m.value,user_id:g.id,role:g.role,created_at:new Date().toISOString()})),{error:_}=await y.from(b.PROJECT_COLLABORATORS).insert(d);if(_)throw console.error("Error adding collaborators:",_),new Error("Project updated, but failed to add collaborators")}await B(),Q()}catch(s){console.error("Error updating project:",s),C.value=s.message}finally{G.value=!1}},Ue=()=>{le.value=!0,I.value=null},ie=()=>{le.value=!1},Te=async()=>{K.value=!0,I.value=null;try{const{error:s}=await y.from(b.PROJECT_COLLABORATORS).delete().eq("project_id",m.value);s&&console.error("Error deleting collaborators:",s);const{error:r}=await y.from(b.PROJECT_UPDATES).delete().eq("project_id",m.value);r&&console.error("Error deleting updates:",r);const{error:d}=await y.from(b.PROJECT_FILES).delete().eq("project_id",m.value);d&&console.error("Error deleting files:",d);const{error:_}=await y.from(b.PROJECTS).delete().eq("id",m.value);if(_)throw _;q.push("/projects")}catch(s){console.error("Error deleting project:",s),I.value=s.message}finally{K.value=!1}},Ae=async(s,r)=>{W.value=s;try{const{error:d}=await y.from(b.PROJECT_COLLABORATORS).update({role:r}).eq("project_id",m.value).eq("user_id",s);if(d)throw d;await B()}catch(d){console.error("Error updating collaborator role:",d),C.value="Failed to update collaborator role"}finally{W.value=null}},Fe=s=>{V.value=s,re.value=!0},X=()=>{re.value=!1,V.value=null},Le=async()=>{if(V.value){Y.value=!0;try{const{error:s}=await y.from(b.PROJECT_COLLABORATORS).delete().eq("project_id",m.value).eq("user_id",V.value.user_id);if(s)throw s;await B(),X()}catch(s){console.error("Error removing collaborator:",s),C.value="Failed to remove collaborator"}finally{Y.value=!1}}},xe=async s=>{try{if(!s||!s.file_path){j.value="Invalid file information";return}await ge(s.file_path)}catch(r){console.error("Error downloading file:",r),j.value="Failed to download the file"}},ue=async s=>{try{await ke(s.file_path,s.id)?l.value.files=l.value.files.filter(d=>d.id!==s.id):j.value="Failed to delete file. Please try again."}catch(r){console.error("Error deleting file:",r),j.value="An error occurred while deleting the file."}};return Ve(()=>{m.value=fe.params.id,m.value?B():q.push("/projects")}),(s,r)=>{var d,_,g,$,A,R,z;return a(),t("div",We,[se.value?(a(),t("div",Ye," Loading project details... ")):j.value?(a(),t("div",He,n(j.value),1)):l.value?(a(),t("div",Qe,[e("div",Xe,[e("div",{class:"back-button",onClick:r[0]||(r[0]=o=>S(q).go(-1))}," ← Back "),e("h1",null,n(l.value.name||l.value.title||"Untitled Project"),1),e("div",Ze,[e("span",eo,"Created "+n(de(l.value.created_at)),1),e("span",oo,"v"+n(l.value.version||"1.0.0"),1)])]),e("div",so,[e("div",to,[e("div",ao,[lo,e("p",null,n(l.value.description||"No description provided"),1)]),e("div",ro,[e("div",io,[no,e("div",co,[e("div",uo,[(d=l.value.owner)!=null&&d.avatar_url?(a(),t("img",{key:0,src:l.value.owner.avatar_url,alt:l.value.owner.display_name,referrerpolicy:"no-referrer"},null,8,vo)):(a(),t("div",_o,n((($=(g=(_=l.value.owner)==null?void 0:_.display_name)==null?void 0:g[0])==null?void 0:$.toUpperCase())||"?"),1))]),e("span",null,n(((A=l.value.owner)==null?void 0:A.display_name)||"Unknown"),1)])]),l.value.collaborators&&l.value.collaborators.length>0?(a(),t("div",po,[ho,e("div",fo,[(a(!0),t(F,null,L(l.value.collaborators,o=>{var c,i,h,f,k,O;return a(),t("div",{key:((c=o.user)==null?void 0:c.id)||o.id,class:"collaborator-item"},[e("div",mo,[(i=o.user)!=null&&i.avatar_url?(a(),t("img",{key:0,src:o.user.avatar_url,alt:o.user.display_name,referrerpolicy:"no-referrer"},null,8,bo)):(a(),t("div",yo,n(((k=(f=(h=o.user)==null?void 0:h.display_name)==null?void 0:f[0])==null?void 0:k.toUpperCase())||"?"),1))]),e("div",go,[e("span",wo,n(((O=o.user)==null?void 0:O.display_name)||"Unknown User"),1),e("span",{class:Ge(["role-icon",o.role]),title:o.role},null,10,Co)])])}),128))])])):v("",!0)])]),e("div",ko,[e("div",jo,[Eo,_e(he,{files:l.value.files,layout:"standard",viewMode:"grid",allowDelete:N.value||T.value==="admin",emptyMessage:"No files uploaded yet",onDelete:ue,onDownload:xe,class:"files-grid-improved files-grid-project"},null,8,["files","allowDelete"])]),N.value||T.value==="admin"||T.value==="editor"?(a(),t("div",Po,[Ro,e("div",Oo,[e("button",{class:"btn btn-success",onClick:je},[So,ce(" Add Progress / Update Project ")]),N.value||T.value==="admin"?(a(),t("button",{key:0,class:"btn btn-primary",onClick:Se}," Edit Project ")):v("",!0),N.value||T.value==="admin"?(a(),t("button",{key:1,class:"btn btn-danger",onClick:Ue}," Delete Project ")):v("",!0)])])):v("",!0)])]),e("div",Do,[Uo,l.value.updates&&l.value.updates.length>0?(a(),t("div",To,[(a(!0),t(F,null,L(l.value.updates,o=>{var c,i,h,f,k;return a(),t("div",{key:o.id,class:"update-item"},[e("div",Ao,[e("div",Fo,[e("div",Lo,[(c=o.user)!=null&&c.avatar_url?(a(),t("img",{key:0,src:o.user.avatar_url,alt:o.user.display_name,referrerpolicy:"no-referrer"},null,8,xo)):(a(),t("div",qo,n(((f=(h=(i=o.user)==null?void 0:i.display_name)==null?void 0:h[0])==null?void 0:f.toUpperCase())||"?"),1))]),e("div",null,[e("div",Jo,n(((k=o.user)==null?void 0:k.display_name)||"Unknown User"),1),e("div",Mo,n(de(o.created_at)),1)])])]),e("div",Io,[e("p",Vo,n(o.description),1)]),l.value.files?(a(),t("div",Bo,[_e(he,{files:l.value.files.filter(O=>O.update_id===o.id),layout:"compact",viewMode:"grid",allowDelete:N.value||T.value==="admin",emptyMessage:"No files attached to this update",onDelete:ue},null,8,["files","allowDelete"])])):v("",!0)])}),128))])):(a(),t("div",No,zo))])])):v("",!0),te.value?(a(),t("div",{key:3,class:"modal-overlay",onClick:H},[e("div",{class:"modal-content",onClick:r[2]||(r[2]=x(()=>{},["stop"]))},[e("div",{class:"modal-header"},[Go,e("button",{class:"close-button",onClick:H},"×")]),e("form",{onSubmit:x(Pe,["prevent"]),class:"update-form"},[e("div",Ko,[Wo,D(e("textarea",{id:"update-description","onUpdate:modelValue":r[1]||(r[1]=o=>w.value.description=o),required:"",placeholder:"Describe the progress or updates you've made to the project...",rows:"4"},null,512),[[Z,w.value.description]])]),e("div",Yo,[Ho,e("div",Qo,[e("input",{id:"update-files",type:"file",onChange:Ee,multiple:"",class:"file-input",disabled:P.value},null,40,Xo),Zo]),w.value.files.length?(a(),t("div",es,[(a(!0),t(F,null,L(w.value.files,o=>(a(),t("div",{key:o.name,class:"file-item"},[e("span",null,n(o.name),1),e("small",null,n((o.size/1024).toFixed(1))+" KB",1)]))),128))])):v("",!0),P.value&&w.value.files.length?(a(),t("div",os,[e("div",ss,[e("div",{class:"progress-fill",style:$e({width:`${S(oe)}%`})},null,4)]),e("span",ts,n(S(oe))+"% uploaded",1)])):v("",!0)]),J.value?(a(),t("div",as,n(J.value),1)):v("",!0),e("div",ls,[e("button",{type:"button",class:"btn btn-secondary",onClick:H},"Cancel"),e("button",{type:"submit",class:"btn btn-success",disabled:P.value},n(P.value?"Saving...":"Save Update"),9,rs)])],32)])])):v("",!0),ae.value?(a(),t("div",{key:4,class:"modal-overlay",onClick:Q},[e("div",{class:"modal-content",onClick:r[7]||(r[7]=x(()=>{},["stop"]))},[e("div",{class:"modal-header"},[is,e("button",{class:"close-button",onClick:Q},"×")]),e("form",{onSubmit:x(De,["prevent"]),class:"edit-form"},[e("div",ns,[cs,D(e("input",{id:"edit-name","onUpdate:modelValue":r[3]||(r[3]=o=>p.value.name=o),type:"text",required:"",placeholder:"Enter project name"},null,512),[[Z,p.value.name]])]),e("div",ds,[us,D(e("textarea",{id:"edit-description","onUpdate:modelValue":r[4]||(r[4]=o=>p.value.description=o),placeholder:"Describe your project",rows:"4"},null,512),[[Z,p.value.description]])]),e("div",vs,[e("label",_s,[D(e("input",{type:"checkbox","onUpdate:modelValue":r[5]||(r[5]=o=>p.value.is_public=o)},null,512),[[ze,p.value.is_public]]),ps]),hs]),e("div",fs,[ms,l.value.collaborators&&l.value.collaborators.length>0?(a(),t("div",bs,[ys,e("div",gs,[(a(!0),t(F,null,L(l.value.collaborators,o=>{var c,i,h,f,k,O;return a(),t("div",{key:(c=o.user)==null?void 0:c.id,class:"collab-item"},[e("div",ws,[e("div",Cs,[(i=o.user)!=null&&i.avatar_url?(a(),t("img",{key:0,src:o.user.avatar_url,alt:o.user.display_name,referrerpolicy:"no-referrer"},null,8,ks)):(a(),t("div",js,n(((k=(f=(h=o.user)==null?void 0:h.display_name)==null?void 0:f[0])==null?void 0:k.toUpperCase())||"?"),1))]),e("span",Es,n(((O=o.user)==null?void 0:O.display_name)||"Unknown"),1)]),e("div",Ps,[o.user_id!==l.value.owner_id?D((a(),t("select",{key:0,"onUpdate:modelValue":ne=>o.role=ne,class:"role-select",onChange:ne=>Ae(o.user_id,o.role),disabled:W.value===o.user_id},Us,40,Rs)),[[pe,o.role]]):(a(),t("span",Ts,"Owner")),W.value===o.user_id?(a(),t("div",As)):v("",!0),o.user_id!==l.value.owner_id?(a(),t("button",{key:3,type:"button",class:"remove-btn",onClick:ne=>Fe(o),title:"Remove collaborator"},"×",8,Fs)):v("",!0)])])}),128))])])):v("",!0),e("div",Ls,[xs,e("div",qs,[D(e("input",{id:"user-search","onUpdate:modelValue":r[6]||(r[6]=o=>M.value=o),type:"text",placeholder:"Search by name or email",class:"search-input"},null,512),[[Z,M.value]]),S(me)?(a(),t("div",Js,Is)):v("",!0)]),U.value&&S(ee).length>0?(a(),t("div",Vs,[(a(!0),t(F,null,L(S(ee),o=>{var c,i;return a(),t("div",{key:o.id,class:"search-result-item",onClick:h=>Re(o)},[e("div",Ns,[e("div",$s,[o.avatar_url?(a(),t("img",{key:0,src:o.avatar_url,alt:o.display_name,referrerpolicy:"no-referrer"},null,8,zs)):(a(),t("div",Gs,n(((i=(c=o.display_name)==null?void 0:c[0])==null?void 0:i.toUpperCase())||"?"),1))]),e("div",Ks,[e("div",Ws,n(o.display_name),1),e("div",Ys,n(o.email),1)])]),Hs],8,Bs)}),128))])):U.value&&S(ee).length===0?(a(),t("div",Qs," No users found with that name or email ")):v("",!0)]),p.value.newCollaborators.length>0?(a(),t("div",Xs,[Zs,e("div",et,[(a(!0),t(F,null,L(p.value.newCollaborators,(o,c)=>{var i,h;return a(),t("div",{key:o.id,class:"collab-item"},[e("div",ot,[e("div",st,[o.avatar_url?(a(),t("img",{key:0,src:o.avatar_url,alt:o.display_name,referrerpolicy:"no-referrer"},null,8,tt)):(a(),t("div",at,n(((h=(i=o.display_name)==null?void 0:i[0])==null?void 0:h.toUpperCase())||"?"),1))]),e("span",lt,n(o.display_name),1)]),e("div",rt,[D(e("select",{"onUpdate:modelValue":f=>o.role=f,class:"role-select"},ut,8,it),[[pe,o.role]]),e("button",{type:"button",class:"remove-btn",onClick:f=>Oe(c),title:"Remove"},"×",8,vt)])])}),128))])])):v("",!0)]),C.value?(a(),t("div",_t,n(C.value),1)):v("",!0),e("div",pt,[e("button",{type:"button",class:"btn btn-secondary",onClick:Q},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:G.value},n(G.value?"Saving...":"Save Changes"),9,ht)])],32)])])):v("",!0),le.value?(a(),t("div",{key:5,class:"modal-overlay",onClick:ie},[e("div",{class:"modal-content delete-confirm",onClick:r[8]||(r[8]=x(()=>{},["stop"]))},[e("div",{class:"modal-header"},[ft,e("button",{class:"close-button",onClick:ie},"×")]),e("div",mt,[bt,yt,I.value?(a(),t("div",gt,n(I.value),1)):v("",!0),e("div",wt,[e("button",{type:"button",class:"btn btn-secondary",onClick:ie},"Cancel"),e("button",{type:"button",class:"btn btn-danger confirm-delete-btn",disabled:K.value,onClick:Te},n(K.value?"Deleting...":"Delete Project"),9,Ct)])])])])):v("",!0),re.value?(a(),t("div",{key:6,class:"modal-overlay",onClick:X},[e("div",{class:"modal-content remove-collab-confirm",onClick:r[9]||(r[9]=x(()=>{},["stop"]))},[e("div",{class:"modal-header"},[kt,e("button",{class:"close-button",onClick:X},"×")]),e("div",jt,[e("p",Et,[ce(" Are you sure you want to remove "),e("strong",null,n(((z=(R=V.value)==null?void 0:R.user)==null?void 0:z.display_name)||"this collaborator"),1),ce(" from the project? ")]),Pt,e("div",Rt,[e("button",{type:"button",class:"btn btn-secondary",onClick:X},"Cancel"),e("button",{type:"button",class:"btn btn-danger",onClick:Le,disabled:Y.value},n(Y.value?"Removing...":"Remove Collaborator"),9,Ot)])])])])):v("",!0)])}}};export{Tt as default};
